<div
  class="background d-flex justify-content-center align-items-center align-items-center"
>
  <div class="card">
    <div class="card-header bg-white px-5 pt-4">
      <h2 class="card-title">{{ title }}</h2>
    </div>

    <div class="card-body">
      <ngx-spinner
        [bdColor]="'rgba(51,51,51,0.8)'"
        [name]="'table'"
        [fullScreen]="false"
        [type]="'ball-clip-rotate-multiple'"
      >
      </ngx-spinner>

      <div>
        <div class="d-flex justify-content-between mb-4 mt-2">
          <button class="btn btn-outline-primary adding" routerLink="/users/create">Adicionar</button>
          <form class="input-group form-inline">            
            <input #search (change)="onKey($event)" type="search" class="form-control" placeholder="{{ searchPlaceholder }}"/>
            <div class="input-group-append">
              <button type="submit" (click)="searchData(search.value)"  class="input-group-text btn">
                Buscar                
              </button>
            </div>
          </form>
        </div>

        <div
          *ngIf="data.length < 1"
          class="d-flex justify-content-center align-items-center"
        >
          <span class="m-5 p-5">Nenhum usuário disponível</span>
        </div>
        <table
          *ngIf="data.length > 0"
          class="table table-striped text-justify"
        >
          <thead>
            <tr>
              <th class="pl-3 pr-5" scope="col">#</th>
              <th scope="col">Nome</th>
              <th scope="col">Email</th>
              <th scope="col">Servidor</th>
              <th scope="col">Permissão</th>
              <th class="text-center" scope="col">Ações</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of data | ngbPagination:page:pageSize; index as i">
              <td class="pl-3 pr-5">
                <strong>{{ i + (this.page - 1) * this.pageSize + 1 }}</strong>
              </td>
              <td>{{ user.name | titlecase }}</td>
              <td>
                {{ user.email }}
              </td>
              <td *ngIf="user.server != null">{{ user.server.name }}</td>
              <td *ngIf="user.server == null">Nenhum servidor</td>
              <td *ngIf="user.permission == 0">Moderador</td>
              <td *ngIf="user.permission > 0">
                {{
                  user.permission == 1
                    ? "Administrador"
                    : "Administrador Global"
                }}
              </td>
              <td class="text-center">
                <a class="mr-3 action" routerLink="/users/update/{{ user.id }}">
                  <img src="./assets/icons/edit.svg" alt="" />
                </a>
                <a (click)="openModal(user.id)"  class="action">
                  <img src="./assets/icons/delete.svg" alt="" />
                </a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="card-footer bg-white mt-4">
      <div *ngIf="data.length > 0" class="d-flex justify-content-between pt-3">
        <div>
          <strong class="mr-2">Resultados por página: </strong>
          <select
            class="form-control d-inline"
            style="width: auto"
            [(ngModel)]="pageSize"
            (ngModelChange)="refreshData()"
          >
            <option [ngValue]="2">2</option>
            <option [ngValue]="4">4</option>
            <option [ngValue]="6">6</option>
            <option [ngValue]="10">10</option>
          </select>
        </div>

        <ngb-pagination
          *ngIf="data.length > 0"
          [collectionSize]="collectionSize"
          [(page)]="page"
          [pageSize]="pageSize"
          [maxSize]="3"
          [rotate]="true"
          (pageChange)="refreshData()"
        >
          <ng-template ngbPaginationPrevious>Anterior</ng-template>
          <ng-template ngbPaginationNext>Próximo</ng-template>
        </ngb-pagination>
      </div>
    </div>
  </div>
</div>
